Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     02:12:32     page:   1


PC     Object              F  Line    Source main.src
                           A     1    ; Z8 Encore! ANSI C Compiler Release 3.80
                           A     2    ; -nolocalcse -optsize -fastcall -const=RA
                           A     3    ; -nooptlink -noregvar -reduceopt -debug -
                           A     4    ; -alias 
                           A     5        DEFINE main_TEXT,SPACE=ROM
                           A     6        FILE    ".\main.c"
                           A     7    .debug "C"
                           A     8        SEGMENT ROM_DATA
                           A     9    
                           A    10    
                           A    11    ;**************************** _osc_delay *
                           A    12    ;Name                         Addr/Registe
                           A    13    
                           A    14    
                           A    15    ; Aggregate Stack Size: 0 (words)
                           A    16    
                           A    17    
                           A    18        .FRAME _n_osc_delay,?_n_osc_delay,RDAT
                           A    19        .FRAME _f_osc_delay,?_f_osc_delay,EDAT
                           A    20        SEGMENT main_TEXT
                           A    21    .begrec "fmt_type",10
                           A    22    .define "flags"
                           A    23    .value 0
                           A    24    .class 8
                           A    25    .type 2
                           A    26    .endef
                           A    27    .define "size"
                           A    28    .value 1
                           A    29    .class 8
                           A    30    .type 2
                           A    31    .endef
                           A    32    .define "space"
                           A    33    .value 2
                           A    34    .class 8
                           A    35    .type 2
                           A    36    .endef
                           A    37    .define "type"
                           A    38    .value 3
                           A    39    .class 8
                           A    40    .type 2
                           A    41    .endef
                           A    42    .define "field_width"
                           A    43    .value 4
                           A    44    .class 8
                           A    45    .type 2
                           A    46    .endef
                           A    47    .define "precision"
                           A    48    .value 5
                           A    49    .class 8
                           A    50    .type 2
                           A    51    .endef
                           A    52    .define "print_leading_char"
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     02:12:32     page:   2


PC     Object              F  Line    Source main.src
                           A    53    .value 6
                           A    54    .class 8
                           A    55    .type 2
                           A    56    .endef
                           A    57    .define "dest"
                           A    58    .value 7
                           A    59    .class 8
                           A    60    .type 162
                           A    61    .endef
                           A    62    .define "print_len"
                           A    63    .value 9
                           A    64    .class 8
                           A    65    .type 12
                           A    66    .endef
                           A    67    .endrec "fmt_type"
                           A    68    .begrec "flt_fmt_data",5
                           A    69    .define "pad_whole"
                           A    70    .value 0
                           A    71    .class 8
                           A    72    .type 12
                           A    73    .endef
                           A    74    .define "pad_pre_fract"
                           A    75    .value 1
                           A    76    .class 8
                           A    77    .type 12
                           A    78    .endef
                           A    79    .define "pad_post_fract"
                           A    80    .value 2
                           A    81    .class 8
                           A    82    .type 12
                           A    83    .endef
                           A    84    .define "pad_at"
                           A    85    .value 3
                           A    86    .class 8
                           A    87    .type 162
                           A    88    .endef
                           A    89    .endrec "flt_fmt_data"
                           A    90    .begrec "fmt_control_data",2
                           A    91    .define "status"
                           A    92    .value 0
                           A    93    .class 8
                           A    94    .type 2
                           A    95    .endef
                           A    96    .define "chr"
                           A    97    .value 1
                           A    98    .class 8
                           A    99    .type 2
                           A   100    .endef
                           A   101    .endrec "fmt_control_data"
                           A   102    .begrec "_set_type",4
                           A   103    .define "begin"
                           A   104    .value 0
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     02:12:32     page:   3


PC     Object              F  Line    Source main.src
                           A   105    .class 8
                           A   106    .type 162
                           A   107    .endef
                           A   108    .define "end"
                           A   109    .value 2
                           A   110    .class 8
                           A   111    .type 162
                           A   112    .endef
                           A   113    .endrec "_set_type"
                           A   114    .begrec "near_set_type",2
                           A   115    .define "begin"
                           A   116    .value 0
                           A   117    .class 8
                           A   118    .type 130
                           A   119    .endef
                           A   120    .define "end"
                           A   121    .value 1
                           A   122    .class 8
                           A   123    .type 130
                           A   124    .endef
                           A   125    .endrec "near_set_type"
                           A   126    .begrec "far_set_type",4
                           A   127    .define "begin"
                           A   128    .value 0
                           A   129    .class 8
                           A   130    .type 162
                           A   131    .endef
                           A   132    .define "end"
                           A   133    .value 2
                           A   134    .class 8
                           A   135    .type 162
                           A   136    .endef
                           A   137    .endrec "far_set_type"
                           A   138    .begrec "rom_set_type",4
                           A   139    .define "begin"
                           A   140    .value 0
                           A   141    .class 8
                           A   142    .type 194
                           A   143    .endef
                           A   144    .define "end"
                           A   145    .value 2
                           A   146    .class 8
                           A   147    .type 194
                           A   148    .endef
                           A   149    .endrec "rom_set_type"
                           A   150    .begrec "flt_info",12
                           A   151    .define "flags"
                           A   152    .value 0
                           A   153    .class 8
                           A   154    .type 12
                           A   155    .endef
                           A   156    .define "exp"
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     02:12:32     page:   4


PC     Object              F  Line    Source main.src
                           A   157    .value 1
                           A   158    .class 8
                           A   159    .type 2
                           A   160    .endef
                           A   161    .define "digits"
                           A   162    .value 2
                           A   163    .class 8
                           A   164    .dim 10
                           A   165    .type 108
                           A   166    .endef
                           A   167    .endrec "flt_info"
                           A   168    .begrec "NONAME0",6
                           A   169    .define "baudRate"
                           A   170    .value 0
                           A   171    .class 8
                           A   172    .type 5
                           A   173    .endef
                           A   174    .define "stopBits"
                           A   175    .value 4
                           A   176    .class 8
                           A   177    .type 12
                           A   178    .endef
                           A   179    .define "parity"
                           A   180    .value 5
                           A   181    .class 8
                           A   182    .type 12
                           A   183    .endef
                           A   184    .endrec "NONAME0"
                           A   185    .begrec "NONAME1",5
                           A   186    .define "pBuffer"
                           A   187    .value 0
                           A   188    .class 8
                           A   189    .type 172
                           A   190    .endef
                           A   191    .define "next_in"
                           A   192    .value 2
                           A   193    .class 8
                           A   194    .type 12
                           A   195    .endef
                           A   196    .define "next_out"
                           A   197    .value 3
                           A   198    .class 8
                           A   199    .type 12
                           A   200    .endef
                           A   201    .define "size"
                           A   202    .value 4
                           A   203    .class 8
                           A   204    .type 12
                           A   205    .endef
                           A   206    .endrec "NONAME1"
0000                       A   207    _osc_delay:
                           A   208    .define "_osc_delay"
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     02:12:32     page:   5


PC     Object              F  Line    Source main.src
                           A   209    .value _osc_delay
                           A   210    .class 2
                           A   211    .type 65
                           A   212    .endef
                           A   213    .begfunc "osc_delay",9,"_osc_delay"
0000 D6 0000               A   214        CALL    __b_frameset00
                           A   215    .line 11
     000001A0              A   216    DELAY_COUNT .set (15000/36)
                           A   217    .line 12
0003 70EC                  A   218        push R12
                           A   219    .line 13
0005 70ED                  A   220        push R13
                           A   221    .line 14
0007 70EE                  A   222        push R14
                           A   223    .line 15
0009 70EF                  A   224        push R15
                           A   225    .line 17
000B CC00                  A   226        LD   R12, #HIGH(DELAY_COUNT>>16)
                           A   227    .line 18
000D DC00                  A   228        LD   R13, #LOW(DELAY_COUNT>>16)
                           A   229    .line 19
000F EC01                  A   230        LD   R14, #HIGH(DELAY_COUNT)
                           A   231    .line 20
0011 FCA0                  A   232        LD   R15, #LOW(DELAY_COUNT)
                           A   233    .line 22
0013                       A   234    $delayCountDown:
                           A   235    .line 23
0013 A6EF00                A   236        CP   R15,#%0
                           A   237    .line 24
0016 1FA6EE00              A   238        CPC  R14,#%0
                           A   239    .line 25
001A 1FA6ED00              A   240        CPC  R13,#%0
                           A   241    .line 26
001E 1FA6EC00              A   242        CPC  R12,#%0
                           A   243    .line 27
0022 3B 0E                 A   244        JR   ule,$delay_done
                           A   245    .line 28
0024 26EF01                A   246        SUB  R15,#%1
                           A   247    .line 29
0027 36EE00                A   248        SBC  R14,#%0
                           A   249    .line 30
002A 36ED00                A   250        SBC  R13,#%0
                           A   251    .line 31
002D 36EC00                A   252        SBC  R12,#%0
                           A   253    .line 32
0030 8B E1                 A   254        jr $delayCountDown
                           A   255    .line 33
0032                       A   256    $delay_done:
                           A   257    .line 34
0032 50EF                  A   258        pop R15
                           A   259    .line 35
0034 50EE                  A   260        pop R14
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     02:12:32     page:   6


PC     Object              F  Line    Source main.src
                           A   261    .line 36
0036 50ED                  A   262        pop R13
                           A   263    .line 37
0038 50EC                  A   264        pop R12
                           A   265    .line 38
003A D6 0000               A   266        CALL    __b_framereset
003D AF                    A   267        RET 
                           A   268    .endfunc "osc_delay",38,"_osc_delay"
                           A   269        SEGMENT ROM_DATA
                           A   270    
                           A   271    
                           A   272    ;**************************** _init_system
                           A   273    ;Name                         Addr/Registe
                           A   274    
                           A   275    
                           A   276    ; Aggregate Stack Size: 0 (words)
                           A   277    
                           A   278    
                           A   279        .FRAME _n_init_systemclock,?_n_init_sy
                           A   280        .FRAME _f_init_systemclock,?_f_init_sy
                           A   281        SEGMENT main_TEXT
003E                       A   282    _init_systemclock:
                           A   283    .define "_init_systemclock"
                           A   284    .value _init_systemclock
                           A   285    .class 2
                           A   286    .type 65
                           A   287    .endef
                           A   288    .begfunc "init_systemclock",44,"_init_syst
003E D6 0000               A   289        CALL    __b_frameset00
                           A   290    .line 58
0041 840F86                A   291        LDX R0,3974
0044 56E087                A   292        AND R0,#135
0047 E4E0E1                A   293        LD  R1,R0
004A A6E080                A   294        CP  R0,#128
004D 6B 0C                 A   295        JR  Z,_2_L_2
                           A   296    .line 60
004F E9E70F86              A   297        LDX 3974,#231
                           A   298    .line 61
0053 E9180F86              A   299        LDX 3974,#24
                           A   300    .line 62
0057 E9800F86              A   301        LDX 3974,#128
005B                       A   302    _2_L_2:
                           A   303    .line 65
005B D6 0000               A   304        CALL    __b_framereset
005E AF                    A   305        RET 
                           A   306    .endfunc "init_systemclock",65,"_init_syst
                           A   307        SEGMENT FAR_DATA
0000                       A   308    _ProgStat:
0000 0001                  A   309        DW  1
                           A   310    .define "ProgStat"
                           A   311    .alias "_ProgStat"
                           A   312    .class 69
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     02:12:32     page:   7


PC     Object              F  Line    Source main.src
                           A   313    .value _ProgStat
                           A   314    .type 3
                           A   315    .endef
                           A   316        SEGMENT ROM_DATA
                           A   317    
                           A   318    
                           A   319    ;**************************** _main ******
                           A   320    ;Name                         Addr/Registe
                           A   321    ;_flash_led                          IMPOR
                           A   322    ;_EI                                 IMPOR
                           A   323    ;_init_led                           IMPOR
                           A   324    ;_init_uart0                         IMPOR
                           A   325    ;_DI                                 IMPOR
                           A   326    ;_init_timer0                        IMPOR
                           A   327    
                           A   328    
                           A   329    ; Aggregate Stack Size: 0 (words)
                           A   330    
                           A   331    
                           A   332        .FRAME _n_main,?_n_main,RDATA
                           A   333        .FCALL _n_init_timer0
                           A   334        .FCALL _n_init_uart0
                           A   335        .FCALL _n_init_led
                           A   336        .FCALL _n_flash_led
                           A   337        .FRAME _f_main,?_f_main,EDATA
                           A   338        .FCALL _f_init_timer0
                           A   339        .FCALL _f_init_uart0
                           A   340        .FCALL _f_init_led
                           A   341        .FCALL _f_flash_led
                           A   342        SEGMENT main_TEXT
                           A   343    ;    1  // Copyright (c) 2024 AlexDev404 (
                           A   344    ;    2  // Zilog 8-Bit Encore! STK500v1 Bo
                           A   345    ;    3  #include <eZ8.h>
                           A   346    ;    4  #include <stdio.h>
                           A   347    ;    5  #include <sio.h> // non-standard I
                           A   348    ;    6  #include "clock.h"
                           A   349    ;    7  #include "uart.h"
                           A   350    ;    8  #include "led.h"
                           A   351    ;    9  
                           A   352    ;   10  #ifndef LED_START_FLASHES
                           A   353    ;   11  #define LED_START_FLASHES 1
                           A   354    ;   12  #endif
                           A   355    ;   13  
                           A   356    ;   14  void main ()
                           A   357    ;   15  {
005F                       A   358    _main:
                           A   359    .define "_main"
                           A   360    .value _main
                           A   361    .class 2
                           A   362    .type 65
                           A   363    .endef
                           A   364    .begfunc "main",15,"_main"
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     02:12:32     page:   8


PC     Object              F  Line    Source main.src
005F D6 0000               A   365        CALL    __b_frameset00
                           A   366    ;   16      //init_systemclock();
                           A   367    ;   17      init_timer0();
                           A   368    .line 17
0062 D6 0000               A   369        CALL    _init_timer0
                           A   370    ;   18      DI();   
                           A   371    .line 18
0065 8F                    A   372        DI
                           A   373    ;   19      init_uart0();                 
                           A   374    .line 19
0066 D6 0000               A   375        CALL    _init_uart0
                           A   376    ;   20      init_led();
                           A   377    .line 20
0069 D6 0000               A   378        CALL    _init_led
                           A   379    ;   21      EI();                         
                           A   380    .line 21
006C 9F                    A   381        EI
                           A   382    ;   22      #if LED_START_FLASHES > 0
                           A   383    ;   23      /* Flash onboard LED to signal
                           A   384    ;   24      flash_led(LED_START_FLASHES * 
                           A   385    .line 24
006D B0E8                  A   386        CLR R8
006F 9C02                  A   387        LD  R9,#2
0071 D6 0000               A   388        CALL    _flash_led
                           A   389    ;   25      #endif
                           A   390    ;   26      //PCOUT |= 0x08;    // Turn of
                           A   391    ;   27      //flash_led(10);
                           A   392    ;   28  
                           A   393    ;   29      for(;;)                     //
0074                       A   394    _3_L_3:
                           A   395    .line 29
                           A   396    ;   30      {
                           A   397    ;   31          //flash_led(2);
                           A   398    ;   32          //putch(getch());
                           A   399    ;   33          
                           A   400    ;   34      }
                           A   401    .line 34
0074 8B FE                 A   402        JR  _3_L_3
                           A   403    ;   35  
                           A   404    ;   36  }   // End of main program
                           A   405    .line 36
0076 D6 0000               A   406        CALL    __b_framereset
0079 AF                    A   407        RET 
                           A   408    .endfunc "main",36,"_main"
                           A   409        XREF _flash_led:ROM
                           A   410        XREF _init_led:ROM
                           A   411        XREF _init_timer0:ROM
                           A   412        XREF _init_uart0:ROM
                           A   413        XREF __b_framereset:ROM
                           A   414        XREF __b_frameset00:ROM
                           A   415        XDEF _main
                           A   416        XDEF _ProgStat
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     02:12:32     page:   9


PC     Object              F  Line    Source main.src
                           A   417        XDEF _init_systemclock
                           A   418        XDEF _osc_delay
                           A   419        END


Errors: 0
Warnings: 0
Lines Assembled: 420
