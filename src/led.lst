Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     03:29:23     page:   1


PC     Object              F  Line    Source led.src
                           A     1    ; Z8 Encore! ANSI C Compiler Release 3.80
                           A     2    ; -nolocalcse -optsize -fastcall -const=RA
                           A     3    ; -nooptlink -noregvar -reduceopt -debug -
                           A     4    ; -alias 
                           A     5        DEFINE led_TEXT,SPACE=ROM
                           A     6        FILE    ".\led.c"
                           A     7    .debug "C"
                           A     8        SEGMENT FAR_DATA
0000                       A     9    _ProgStat:
0000 0001                  A    10        DW  1
                           A    11    .define "ProgStat"
                           A    12    .alias "_ProgStat"
                           A    13    .class 69
                           A    14    .value _ProgStat
                           A    15    .type 3
                           A    16    .endef
                           A    17        SEGMENT led_TEXT
                           A    18    .begrec "fmt_type",10
                           A    19    .define "flags"
                           A    20    .value 0
                           A    21    .class 8
                           A    22    .type 2
                           A    23    .endef
                           A    24    .define "size"
                           A    25    .value 1
                           A    26    .class 8
                           A    27    .type 2
                           A    28    .endef
                           A    29    .define "space"
                           A    30    .value 2
                           A    31    .class 8
                           A    32    .type 2
                           A    33    .endef
                           A    34    .define "type"
                           A    35    .value 3
                           A    36    .class 8
                           A    37    .type 2
                           A    38    .endef
                           A    39    .define "field_width"
                           A    40    .value 4
                           A    41    .class 8
                           A    42    .type 2
                           A    43    .endef
                           A    44    .define "precision"
                           A    45    .value 5
                           A    46    .class 8
                           A    47    .type 2
                           A    48    .endef
                           A    49    .define "print_leading_char"
                           A    50    .value 6
                           A    51    .class 8
                           A    52    .type 2
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     03:29:23     page:   2


PC     Object              F  Line    Source led.src
                           A    53    .endef
                           A    54    .define "dest"
                           A    55    .value 7
                           A    56    .class 8
                           A    57    .type 162
                           A    58    .endef
                           A    59    .define "print_len"
                           A    60    .value 9
                           A    61    .class 8
                           A    62    .type 12
                           A    63    .endef
                           A    64    .endrec "fmt_type"
                           A    65    .begrec "flt_fmt_data",5
                           A    66    .define "pad_whole"
                           A    67    .value 0
                           A    68    .class 8
                           A    69    .type 12
                           A    70    .endef
                           A    71    .define "pad_pre_fract"
                           A    72    .value 1
                           A    73    .class 8
                           A    74    .type 12
                           A    75    .endef
                           A    76    .define "pad_post_fract"
                           A    77    .value 2
                           A    78    .class 8
                           A    79    .type 12
                           A    80    .endef
                           A    81    .define "pad_at"
                           A    82    .value 3
                           A    83    .class 8
                           A    84    .type 162
                           A    85    .endef
                           A    86    .endrec "flt_fmt_data"
                           A    87    .begrec "fmt_control_data",2
                           A    88    .define "status"
                           A    89    .value 0
                           A    90    .class 8
                           A    91    .type 2
                           A    92    .endef
                           A    93    .define "chr"
                           A    94    .value 1
                           A    95    .class 8
                           A    96    .type 2
                           A    97    .endef
                           A    98    .endrec "fmt_control_data"
                           A    99    .begrec "_set_type",4
                           A   100    .define "begin"
                           A   101    .value 0
                           A   102    .class 8
                           A   103    .type 162
                           A   104    .endef
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     03:29:23     page:   3


PC     Object              F  Line    Source led.src
                           A   105    .define "end"
                           A   106    .value 2
                           A   107    .class 8
                           A   108    .type 162
                           A   109    .endef
                           A   110    .endrec "_set_type"
                           A   111    .begrec "near_set_type",2
                           A   112    .define "begin"
                           A   113    .value 0
                           A   114    .class 8
                           A   115    .type 130
                           A   116    .endef
                           A   117    .define "end"
                           A   118    .value 1
                           A   119    .class 8
                           A   120    .type 130
                           A   121    .endef
                           A   122    .endrec "near_set_type"
                           A   123    .begrec "far_set_type",4
                           A   124    .define "begin"
                           A   125    .value 0
                           A   126    .class 8
                           A   127    .type 162
                           A   128    .endef
                           A   129    .define "end"
                           A   130    .value 2
                           A   131    .class 8
                           A   132    .type 162
                           A   133    .endef
                           A   134    .endrec "far_set_type"
                           A   135    .begrec "rom_set_type",4
                           A   136    .define "begin"
                           A   137    .value 0
                           A   138    .class 8
                           A   139    .type 194
                           A   140    .endef
                           A   141    .define "end"
                           A   142    .value 2
                           A   143    .class 8
                           A   144    .type 194
                           A   145    .endef
                           A   146    .endrec "rom_set_type"
                           A   147    .begrec "flt_info",12
                           A   148    .define "flags"
                           A   149    .value 0
                           A   150    .class 8
                           A   151    .type 12
                           A   152    .endef
                           A   153    .define "exp"
                           A   154    .value 1
                           A   155    .class 8
                           A   156    .type 2
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     03:29:23     page:   4


PC     Object              F  Line    Source led.src
                           A   157    .endef
                           A   158    .define "digits"
                           A   159    .value 2
                           A   160    .class 8
                           A   161    .dim 10
                           A   162    .type 108
                           A   163    .endef
                           A   164    .endrec "flt_info"
                           A   165    .begrec "NONAME0",6
                           A   166    .define "baudRate"
                           A   167    .value 0
                           A   168    .class 8
                           A   169    .type 5
                           A   170    .endef
                           A   171    .define "stopBits"
                           A   172    .value 4
                           A   173    .class 8
                           A   174    .type 12
                           A   175    .endef
                           A   176    .define "parity"
                           A   177    .value 5
                           A   178    .class 8
                           A   179    .type 12
                           A   180    .endef
                           A   181    .endrec "NONAME0"
                           A   182    .begrec "NONAME1",5
                           A   183    .define "pBuffer"
                           A   184    .value 0
                           A   185    .class 8
                           A   186    .type 172
                           A   187    .endef
                           A   188    .define "next_in"
                           A   189    .value 2
                           A   190    .class 8
                           A   191    .type 12
                           A   192    .endef
                           A   193    .define "next_out"
                           A   194    .value 3
                           A   195    .class 8
                           A   196    .type 12
                           A   197    .endef
                           A   198    .define "size"
                           A   199    .value 4
                           A   200    .class 8
                           A   201    .type 12
                           A   202    .endef
                           A   203    .endrec "NONAME1"
                           A   204        SEGMENT ROM_DATA
                           A   205    
                           A   206    
                           A   207    ;**************************** _setStatus *
                           A   208    ;Name                         Addr/Registe
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     03:29:23     page:   5


PC     Object              F  Line    Source led.src
                           A   209    ;_ProgStat                           STATI
                           A   210    ;status                                 RR
                           A   211    
                           A   212    
                           A   213    ; Aggregate Stack Size: 0 (words)
                           A   214    
                           A   215    
                           A   216        .FRAME _n_setStatus,?_n_setStatus,RDAT
                           A   217        .FRAME _f_setStatus,?_f_setStatus,EDAT
                           A   218        SEGMENT led_TEXT
                           A   219    ;    1  // (c) 2024 AlexDev404
                           A   220    ;    2  #include <ez8.h>
                           A   221    ;    3  #include <sio.h> // putch(char)
                           A   222    ;    4  #include "led.h"
                           A   223    ;    5  
                           A   224    ;    6  void setStatus( int status )
                           A   225    ;    7  {
0000                       A   226    _setStatus:
                           A   227    .define "_setStatus"
                           A   228    .value _setStatus
                           A   229    .class 2
                           A   230    .type 65
                           A   231    .endef
                           A   232    .begfunc "setStatus",7,"_setStatus"
                           A   233    .define "status"
                           A   234    .class 17
                           A   235    .reg 21
                           A   236    .type 3
                           A   237    .endef
0000 D6 0000               A   238        CALL    __b_frameset00
                           A   239    ;    8       ProgStat = status;         //
                           A   240    .line 8
0003 948000                A   241        LDX _ProgStat,R8
0006 949001                A   242        LDX _ProgStat+1,R9
                           A   243    ;    9  }
                           A   244    .line 9
0009 D6 0000               A   245        CALL    __b_framereset
000C AF                    A   246        RET 
                           A   247    .endfunc "setStatus",9,"_setStatus"
                           A   248        SEGMENT ROM_DATA
                           A   249    
                           A   250    
                           A   251    ;**************************** _init_led **
                           A   252    ;Name                         Addr/Registe
                           A   253    
                           A   254    
                           A   255    ; Aggregate Stack Size: 0 (words)
                           A   256    
                           A   257    
                           A   258        .FRAME _n_init_led,?_n_init_led,RDATA
                           A   259        .FRAME _f_init_led,?_f_init_led,EDATA
                           A   260        SEGMENT led_TEXT
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     03:29:23     page:   6


PC     Object              F  Line    Source led.src
                           A   261    ;   10  
                           A   262    ;   11  void init_led(){
000D                       A   263    _init_led:
                           A   264    .define "_init_led"
                           A   265    .value _init_led
                           A   266    .class 2
                           A   267    .type 65
                           A   268    .endef
                           A   269    .begfunc "init_led",11,"_init_led"
000D D6 0000               A   270        CALL    __b_frameset00
                           A   271    ;   12  
                           A   272    ;   13    PCADDR    = 0x01;     // PC Data
                           A   273    .line 13
0010 E9010FD8              A   274        LDX 4056,#1
                           A   275    ;   14    PCCTL     &= 0xF7;    // PC3 as 
                           A   276    .line 14
0014 59F70FD9              A   277        ANDX    4057,#247
                           A   278    ;   15    LEDEN     = 0x08;     // PC3 use
                           A   279    .line 15
0018 E9080F82              A   280        LDX 3970,#8
                           A   281    ;   16    LEDLVLH   = 0x08;     // PC3 Led
                           A   282    .line 16
001C E9080F83              A   283        LDX 3971,#8
                           A   284    ;   17    LEDLVLL   = 0x00;
                           A   285    .line 17
0020 E9000F84              A   286        LDX 3972,#-0
                           A   287    ;   18    PCOUT &= 0xF7;        // Turn of
                           A   288    .line 18
0024 59F70FDB              A   289        ANDX    4059,#247
                           A   290    ;   19  }
                           A   291    .line 19
0028 D6 0000               A   292        CALL    __b_framereset
002B AF                    A   293        RET 
                           A   294    .endfunc "init_led",19,"_init_led"
                           A   295        SEGMENT ROM_DATA
                           A   296    
                           A   297    
                           A   298    ;**************************** _flash_led *
                           A   299    ;Name                         Addr/Registe
                           A   300    ;_ProgStat                           STATI
                           A   301    ;i                                   RR14-
                           A   302    ;led_flash_count                        RR
                           A   303    
                           A   304    
                           A   305    ; Aggregate Stack Size: -2 (words)
                           A   306    
                           A   307    
                           A   308        .FRAME _n_flash_led,?_n_flash_led,RDAT
                           A   309        .FRAME _f_flash_led,?_f_flash_led,EDAT
                           A   310        SEGMENT led_TEXT
                           A   311    ;   20  
                           A   312    ;   21  void flash_led(int led_flash_count
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     03:29:23     page:   7


PC     Object              F  Line    Source led.src
002C                       A   313    _flash_led:
                           A   314    .define "_flash_led"
                           A   315    .value _flash_led
                           A   316    .class 2
                           A   317    .type 65
                           A   318    .endef
                           A   319    .begfunc "flash_led",21,"_flash_led"
                           A   320    .define "led_flash_count"
                           A   321    .class 17
                           A   322    .reg 21
                           A   323    .type 3
                           A   324    .endef
                           A   325    .define "i"
                           A   326    .class 1
                           A   327    .value -2
                           A   328    .type 3
                           A   329    .endef
002C 5C02                  A   330        LD  R5,#2
002E D6 0000               A   331        CALL    __b_frameset0
                           A   332    ;   22      int i = 0;
                           A   333    .line 22
0031 B0E0                  A   334        CLR R0
0033 B0E1                  A   335        CLR R1
0035 89E0FE                A   336        LDX -2(RR14),R0
0038 89E1FF                A   337        LDX -1(RR14),R1
                           A   338    ;   23      while(i < led_flash_count){
003B                       A   339    _3_L_5:
                           A   340    .line 23
003B 880EFE                A   341        LDX R0,-2(RR14)
003E 881EFF                A   342        LDX R1,-1(RR14)
0041 A219                  A   343        CP  R1,R9
0043 1FA208                A   344        CPC R0,R8
0046 9B 2D                 A   345        JR  GE,_3_L_7
                           A   346    ;   24          //putch('A');
                           A   347    ;   25          if(ProgStat != BUSY){
                           A   348    .line 25
0048 A9010001              A   349        CPX _ProgStat+1,#1
004C 1FA90000 00           A   350        CPCX    _ProgStat,#0
0051 6B 1C                 A   351        JR  Z,_3_L_4
                           A   352    ;   26              //putch('I');
                           A   353    ;   27              PCOUT |= 0x08;  // Tur
                           A   354    .line 27
0053 49080FDB              A   355        ORX 4059,#8
                           A   356    ;   28              ProgStat = BUSY;
                           A   357    .line 28
0057 E9000000              A   358        LDX _ProgStat,#-0
005B E9010001              A   359        LDX _ProgStat+1,#1
                           A   360    ;   29              i++;
                           A   361    .line 29
005F 880EFE                A   362        LDX R0,-2(RR14)
0062 881EFF                A   363        LDX R1,-1(RR14)
0065 A0E0                  A   364        INCW    RR0
Zilog eZ8 Encore! Macro Assembler Version 2.53 (20121701) 27-May-25     03:29:23     page:   8


PC     Object              F  Line    Source led.src
0067 89E0FE                A   365        LDX -2(RR14),R0
006A 89E1FF                A   366        LDX -1(RR14),R1
                           A   367    ;   30          } else {
                           A   368    .line 30
006D 8B CC                 A   369        JR  _3_L_5
006F                       A   370    _3_L_4:
                           A   371    ;   31              PCOUT &= 0xF7;  // Tur
                           A   372    .line 31
006F 59F70FDB              A   373        ANDX    4059,#247
                           A   374    ;   32          }
                           A   375    ;   33      }
                           A   376    .line 33
0073 8B C6                 A   377        JR  _3_L_5
0075                       A   378    _3_L_7:
                           A   379    ;   34      PCOUT &= 0xF7;  // Turn off PC
                           A   380    .line 34
0075 59F70FDB              A   381        ANDX    4059,#247
                           A   382    .line 35
0079 D6 0000               A   383        CALL    __b_framereset
007C AF                    A   384        RET 
                           A   385    .endfunc "flash_led",35,"_flash_led"
                           A   386        XREF __b_framereset:ROM
                           A   387        XREF __b_frameset0:ROM
                           A   388        XREF __b_frameset00:ROM
                           A   389        XDEF _flash_led
                           A   390        XDEF _init_led
                           A   391        XDEF _setStatus
                           A   392        XDEF _ProgStat
                           A   393        END


Errors: 0
Warnings: 0
Lines Assembled: 394
